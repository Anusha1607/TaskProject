!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common"],e):e(t["ngx-drag-and-drop"]={},t.ng.core,t.ng.common)}(this,function(t,e,o){"use strict";var s=document;s.elementsFromPoint=s.elementsFromPoint||function(t,e){for(var o,r=[],n=[];(o=document.elementFromPoint(t,e))&&o!==document.documentElement;)r.push(o),n.push(o.style.visibility),o.style.visibility="hidden";for(var i=0;i<r.length;i++)r[i].style.visibility=n[i];return r};var r="dragPointer",n=new(function(){function t(){this.draggingPointer=new Map,this.draggedStructures=new Map,this.dropZones=new Map}return t.prototype.preStartDrag=function(n,t,i,s,e,a){var d=this;return this.draggingPointer.set(n,{x:i,y:s}),new Promise(function(o,r){setTimeout(function(){var t=d.draggingPointer.get(n),e=t&&Math.abs(i-t.x)+Math.abs(s-t.y)<a;d.draggingPointer["delete"](n),e?o():r()},Math.max(0,e))})},t.prototype.startDrag=function(e,o,t,r){this.draggedStructures.set(e,o);var n=new Map;return this.dropZones.forEach(function(t){t.checkAccept(o)&&(t.appendDropCandidatePointer(e),n.set(t.root,t))}),n},t.prototype.isAssociatedToDropZone=function(t){return this.dropZones.has(t)},t.prototype.registerDropZone=function(t){this.dropZones.set(t.root,t)},t.prototype.unregisterDropZone=function(t){this.dropZones["delete"](t.root)},t.prototype.pointerMove=function(t,e,o){var r=this.draggingPointer.get(t);r&&(r.x=e,r.y=o);var n=this.draggedStructures.get(t);return n&&n instanceof d&&n.move(e,o),n!==undefined},t.prototype.pointerRelease=function(t){var e=this.draggedStructures.get(t);return e&&e instanceof d&&e.stop(),this.draggedStructures["delete"](t),this.draggingPointer["delete"](t),e!==undefined},t}()),i=!1,a=function(){function t(){this.nbDragEnter=0,i?console.error("Do not create multiple instance of directive drag-and-drop-wrapper !"):i=!0}return t.prototype.removeFeedbackForDragPointer=function(){this.nbDragEnter=0,n.dropZones.forEach(function(t){t.removePointerHover(r),t.removeDropCandidatePointer(r)})},t.prototype.drop=function(t){t.preventDefault(),t.stopPropagation(),this.removeFeedbackForDragPointer()},t.prototype.dragover=function(t){t.preventDefault(),t.stopPropagation()},t.prototype.dragenter=function(t){this.nbDragEnter++,1===this.nbDragEnter&&n.startDrag(r,t,-1,-1)},t.prototype.dragleave=function(t){this.nbDragEnter--,0===this.nbDragEnter&&(this.removeFeedbackForDragPointer(),n.pointerRelease(r))},t.prototype.dragend=function(t){n.pointerRelease(r),this.removeFeedbackForDragPointer(),t.preventDefault()},t.prototype.mousemove=function(t){n.pointerMove("mouse",t.clientX,t.clientY)},t.prototype.mouseup=function(t){n.pointerRelease("mouse")},t.prototype.touchmove=function(t){for(var e=0;e<t.changedTouches.length;e++){var o=t.changedTouches.item(e);n.pointerMove(o.identifier.toString(),o.clientX,o.clientY)&&(t.preventDefault(),t.stopPropagation())}},t.prototype.touchend=function(t){for(var e=0;e<t.changedTouches.length;e++){var o=t.changedTouches.item(e);n.pointerRelease(o.identifier.toString())&&(t.preventDefault(),t.stopPropagation())}},t}();a.decorators=[{type:e.Directive,args:[{selector:"*[drag-and-drop-wrapper]"}]}],a.ctorParameters=function(){return[]},a.propDecorators={drop:[{type:e.HostListener,args:["document: drop",["$event"]]}],dragover:[{type:e.HostListener,args:["document: dragover",["$event"]]}],dragenter:[{type:e.HostListener,args:["document: dragenter",["$event"]]}],dragleave:[{type:e.HostListener,args:["document: dragleave",["$event"]]}],dragend:[{type:e.HostListener,args:["document: dragend",["$event"]]}],mousemove:[{type:e.HostListener,args:["document: mousemove",["$event"]]}],mouseup:[{type:e.HostListener,args:["document: mouseup",["$event"]]}],touchmove:[{type:e.HostListener,args:["document: touchmove",["$event"]]}],touchend:[{type:e.HostListener,args:["document: touchend",["$event"]]}]};var d=function(){function t(t){this.disabled=!1,this.onDragStart=new e.EventEmitter,this.onDragEnd=new e.EventEmitter,this.isBeingDragged=!1,this.cloneNode=null,this.possibleDropZones=new Map,this.root=t.nativeElement,i||console.error("You should add one dragdrop attribute to your code before using draggable")}return t.prototype.ngOnInit=function(){},t.prototype.ngOnDestroy=function(){},t.prototype.onMouseDown=function(t){console.log(this.disabled),this.disabled||(t.preventDefault(),t.stopPropagation(),this.prestart("mouse",t.clientX,t.clientY))},t.prototype.onTouchStart=function(t){t.stopPropagation();for(var e=0;e<t.changedTouches.length;e++){var o=t.changedTouches.item(e);this.prestart(o.identifier.toString(),o.clientX,o.clientY)}},t.prototype.prestart=function(t,e,o){var r=this;n.preStartDrag(t,this,e,o,this.startDelay||0,this.startDistance||10).then(function(){r.start(t,e,o)},function(){})},t.prototype.start=function(t,e,o){if(!this.isBeingDragged){this.isBeingDragged=!0,this.idPointer=t;var r=function(t){for(var e=0,o=0;t;)o+=t.offsetTop-t.scrollTop+t.clientTop,e+=t.offsetLeft-t.scrollLeft+t.clientLeft,t=t.offsetParent;return{left:e,top:o}}(this.root);this.ox=e,this.oy=o,this.dx=e-r.left,this.dy=o-r.top,this.tx=this.root.offsetWidth,this.ty=this.root.offsetHeight,this.getClone(),this.cloneNode.style.left=e-this.dx+"px",this.cloneNode.style.top=o-this.dy+"px",this.onDragStart.emit(this.draggedData),this.possibleDropZones=n.startDrag(t,this,e,o)}},t.prototype.stop=function(){var e=this;this.possibleDropZones.forEach(function(t){t.removePointerHover(e.idPointer),t.removeDropCandidatePointer(e.idPointer)}),this.isBeingDragged=!1,this.possibleDropZones.clear(),this.idPointer=null,this.currentDropZone&&this.currentDropZone.drop(this.draggedData),this.currentDropZone=null,this.onDragEnd.emit(this.draggedData),this.deleteClone()},t.prototype.move=function(t,e){var o=null;if(null===this.cloneNode&&this.getClone(),this.cloneNode){this.cloneNode.style.left=t-this.dx+"px",this.cloneNode.style.top=e-this.dy+"px";var r=this.cloneNode.style.visibility;this.cloneNode.style.visibility="hidden";var n=this.cloneNode.style.top;this.cloneNode.style.top="999999999px",o=s.elementFromPoint(t,e),this.cloneNode.style.top=n,this.cloneNode.style.visibility=r;for(var i=this.currentDropZone;o&&(this.currentDropZone=this.possibleDropZones.get(o),!this.currentDropZone);)o=o.parentElement;i!==this.currentDropZone&&(i&&i.removePointerHover(this.idPointer),this.currentDropZone&&this.currentDropZone.appendPointerHover(this.idPointer))}return this},t.prototype.deepStyle=function(t,e){if(t instanceof HTMLElement){for(var o=window.getComputedStyle(t),r=0;r<o.length;r++){var n=o[r];e.style[n]=o[n]}for(r=0;r<t.children.length;r++)this.deepStyle(t.children.item(r),e.children.item(r))}},t.prototype.deleteClone=function(){this.cloneNode&&(this.cloneNode.parentNode&&this.cloneNode.parentNode.removeChild(this.cloneNode),this.cloneNode=null)},t.prototype.getClone=function(){return null===this.cloneNode&&(this.cloneNode=this.root.cloneNode(!0),this.deepStyle(this.root,this.cloneNode),document.body.appendChild(this.cloneNode),this.cloneNode.style.position="absolute",this.cloneNode.style.zIndex="999",this.cloneNode.style.marginLeft="0",this.cloneNode.style.marginTop="0",this.cloneNode.style.marginRight="0",this.cloneNode.style.marginBottom="0",this.cloneNode.style.opacity="",this.cloneNode.style.cursor="",this.cloneNode.style.transform="",this.cloneNode.style.transformOrigin="",this.cloneNode.style.animation="",this.cloneNode.style.transition="",this.cloneNode.classList.add("drag-and-drop-clone-node")),this.cloneNode},t}();d.decorators=[{type:e.Directive,args:[{selector:"*[draggable]"}]}],d.ctorParameters=function(){return[{type:e.ElementRef}]},d.propDecorators={draggedData:[{type:e.Input,args:["draggable"]}],startDelay:[{type:e.Input,args:["drag-start-delay"]}],startDistance:[{type:e.Input,args:["start-distance"]}],disabled:[{type:e.Input,args:["disabled"]}],onDragStart:[{type:e.Output,args:["drag-start"]}],onDragEnd:[{type:e.Output,args:["drag-end"]}],onMouseDown:[{type:e.HostListener,args:["mousedown",["$event"]]}],onTouchStart:[{type:e.HostListener,args:["touchstart",["$event"]]}]};var p=function(){function t(t){this.nbDragEnter=0,this.onDropEmitter=new e.EventEmitter,this.onDragStart=new e.EventEmitter,this.onDragEnd=new e.EventEmitter,this.onDragEnter=new e.EventEmitter,this.onDragLeave=new e.EventEmitter,this.dropCandidateofPointers=[],this.pointersHover=[],i||console.error("You should add one dragdrop attribute to your code before using dropzone"),this.root=t.nativeElement,n.registerDropZone(this)}return t.prototype.ngOnInit=function(){},t.prototype.ngOnDestroy=function(){n.unregisterDropZone(this)},t.prototype.BrowserDragEnter=function(t){this.nbDragEnter++,1===this.nbDragEnter&&this.appendPointerHover(r)},t.prototype.BrowserDragLeave=function(t){this.nbDragEnter--,0===this.nbDragEnter&&this.removePointerHover(r)},t.prototype.BrowserDrop=function(t){n.pointerRelease(r),this.nbDragEnter=0,this.onDropEmitter.emit(t)},t.prototype.drop=function(t){this.onDropEmitter.emit(t)},t.prototype.checkAccept=function(t){return t instanceof d?!this.acceptFunction||this.acceptFunction(t.draggedData):!this.acceptFunction||this.acceptFunction(t)},t.prototype.hasPointerHover=function(t){return 0<=this.pointersHover.indexOf(t)},t.prototype.appendPointerHover=function(t){if(-1===this.pointersHover.indexOf(t)){var e=n.draggedStructures.get(t);this.pointersHover.push(t),e instanceof d?(this.dragOverCSS_pointer&&e.getClone().classList.add(this.dragOverCSS_pointer),this.onDragEnter.emit(e.draggedData)):this.onDragEnter.emit(e),this.dragOverCSS&&this.root.classList.add(this.dragOverCSS)}},t.prototype.removePointerHover=function(t){var e=this.pointersHover.indexOf(t);if(0<=e){var o=n.draggedStructures.get(t);this.pointersHover.splice(e,1),o instanceof d?(this.dragOverCSS_pointer&&o.getClone().classList.remove(this.dragOverCSS_pointer),this.onDragLeave.emit(o.draggedData)):this.onDragLeave.emit(o),0===this.pointersHover.length&&this.dragOverCSS&&this.root.classList.remove(this.dragOverCSS)}},t.prototype.appendDropCandidatePointer=function(t){if(-1===this.dropCandidateofPointers.indexOf(t)){var e=n.draggedStructures.get(t);e instanceof d?this.onDragStart.emit(e.draggedData):this.onDragStart.emit(e),this.dropCandidateofPointers.push(t),this.dragCSS&&this.root.classList.add(this.dragCSS)}},t.prototype.removeDropCandidatePointer=function(t){var e=this.dropCandidateofPointers.indexOf(t);if(0<=e){var o=n.draggedStructures.get(t);o instanceof d?this.onDragEnd.emit(o.draggedData):this.onDragEnd.emit(o),this.dropCandidateofPointers.splice(e,1),0===this.dropCandidateofPointers.length&&this.dragCSS&&this.root.classList.remove(this.dragCSS)}},t}();p.decorators=[{type:e.Directive,args:[{selector:"*[dropzone]"}]}],p.ctorParameters=function(){return[{type:e.ElementRef}]},p.propDecorators={dragCSS:[{type:e.Input,args:["drag-css"]}],dragOverCSS:[{type:e.Input,args:["drag-over-css"]}],dragOverCSS_pointer:[{type:e.Input,args:["drag-over-css-for-draggable"]}],acceptFunction:[{type:e.Input,args:["accept-function"]}],onDropEmitter:[{type:e.Output,args:["ondrop"]}],onDragStart:[{type:e.Output,args:["drag-start"]}],onDragEnd:[{type:e.Output,args:["drag-end"]}],onDragEnter:[{type:e.Output,args:["drag-enter"]}],onDragLeave:[{type:e.Output,args:["drag-leave"]}],BrowserDragEnter:[{type:e.HostListener,args:["dragenter",["$event"]]}],BrowserDragLeave:[{type:e.HostListener,args:["dragleave",["$event"]]}],BrowserDrop:[{type:e.HostListener,args:["drop",["$event"]]}]};var c=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[]}},t}();c.decorators=[{type:e.NgModule,args:[{imports:[o.CommonModule],declarations:[d,p,a],exports:[d,p,a]}]}],c.ctorParameters=function(){return[]},t.NgxDragAndDropModule=c,t.ɵa=a,t.ɵb=d,t.ɵc=p,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-drag-and-drop.umd.min.js.map
